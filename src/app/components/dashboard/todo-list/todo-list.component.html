<div class="spinner-border" role="status" *ngIf="isLoading">
  <span class="visually-hidden">Loading...</span>
</div>

<app-data-table-control-panel
  *ngIf="!isLoading && allowedToView([UserRole.Admin, UserRole.SuperAdmin])"
  (createRow)="assignTo()"
  [userType]="userType"
  [createRowLabel]="'Assign Task'"
  [searchBox]="pageState.search"
  (searchBoxChange)="onPageChange({ search: $event })"
  [searchBoxPlaceholder]="'Search todos here'"
></app-data-table-control-panel>

<div class="scroll" *ngIf="!isLoading">
  <table class="table table-hover">
    <thead>
      <tr
        class="todo-list-header"
        app-todo-list-header
        [cols]="cols"
        [userType]="userType"
        (clicked)="onClickedHeader($event)"
        (pageStateChange)="onPageChange($event)"
        [pageState]="pageState"
      ></tr>
    </thead>
    <tbody class="scroll">
      <tr
        *ngFor="let todo of todos; let i = index"
        app-todo
        [todo]="todo"
        [sno]="pageState.index * pageState.take + (i + 1)"
        (updateTodo)="updateTodo($event)"
        (deleteTodo)="deleteTodo($event)"
        (navigateTo)="navigateTo($event)"
        [userType]="userType"
        [isLoading]="isLoading"
      ></tr>
      <tr *ngIf="!(todos && todos.length !== 0)">
        <th [colSpan]="7">"Nothing Here"</th>
      </tr>
    </tbody>
  </table>
</div>
<app-pagination
  *ngIf="!isLoading"
  [(selectedPage)]="pageState.index"
  (pageChange)="onPageChange({ index: $event })"
  [collectionSize]="totalPagesCount"
  [selectedPaginatedSize]="pageState.take"
  (selectedPaginatedSizeChange)="onPageChange({ take: $event })"
/>

<app-confirmation-modal
  (confirmation)="confirm($event)"
></app-confirmation-modal>
